<!-- Schwab OAuth2 Information Modal -->
<div id="schwab-oauth-info" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-gray-800 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <div class="p-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-white">Schwab OAuth2 Integration</h3>
                <button onclick="closeSchwabInfo()" class="text-gray-400 hover:text-white">
                    <i data-feather="x" class="w-5 h-5"></i>
                </button>
            </div>
            
            <div class="space-y-4 text-gray-300">
                <div class="bg-blue-900 bg-opacity-50 rounded-lg p-4 border border-blue-500">
                    <h4 class="font-medium text-blue-300 mb-2">Why OAuth2?</h4>
                    <p class="text-sm">
                        OAuth2 with PKCE is the secure, recommended method for Schwab API integration. 
                        It provides better security than API keys and is required for production use.
                    </p>
                </div>
                
                <div class="bg-green-900 bg-opacity-50 rounded-lg p-4 border border-green-500">
                    <h4 class="font-medium text-green-300 mb-2">How It Works</h4>
                    <ol class="text-sm space-y-1 list-decimal list-inside">
                        <li>Click "Authenticate with Schwab OAuth2"</li>
                        <li>You'll be redirected to Schwab's secure login page</li>
                        <li>Log in with your Schwab credentials</li>
                        <li>Authorize Arbion to access your account</li>
                        <li>You'll be redirected back to Arbion with secure tokens</li>
                    </ol>
                </div>
                
                <div class="bg-yellow-900 bg-opacity-50 rounded-lg p-4 border border-yellow-500">
                    <h4 class="font-medium text-yellow-300 mb-2">Security Features</h4>
                    <ul class="text-sm space-y-1 list-disc list-inside">
                        <li>PKCE (Proof Key for Code Exchange) for enhanced security</li>
                        <li>Tokens are encrypted and stored securely</li>
                        <li>Automatic token refresh when expired</li>
                        <li>No sensitive credentials stored in browser</li>
                    </ul>
                </div>
                
                {% if not schwab_oauth_configured %}
                <div class="bg-amber-900 bg-opacity-50 rounded-lg p-4 border border-amber-500 mb-4">
                    <h4 class="font-medium text-amber-300 mb-2">Setup Required</h4>
                    <p class="text-sm">
                        <strong>Current Status:</strong> Schwab OAuth2 requires platform configuration.<br>
                        <strong>Error:</strong> "Schwab client ID not configured"
                    </p>
                </div>
                {% else %}
                <div class="bg-green-900 bg-opacity-50 rounded-lg p-4 border border-green-500 mb-4">
                    <h4 class="font-medium text-green-300 mb-2">Ready for Authentication</h4>
                    <p class="text-sm">
                        <strong>Status:</strong> Schwab OAuth2 is properly configured and ready to use.<br>
                        <strong>Redirect URI:</strong> https://www.arbion.ai/oauth_callback/schwab
                    </p>
                </div>
                {% endif %}
                
                <div class="bg-blue-900 bg-opacity-50 rounded-lg p-4 border border-blue-500 mb-4">
                    <h4 class="font-medium text-blue-300 mb-2">How to Set Up Schwab OAuth2</h4>
                    <ol class="text-sm space-y-2 list-decimal list-inside">
                        <li>Apply for Schwab Developer Account at <a href="https://developer.schwab.com" target="_blank" class="text-blue-400 hover:text-blue-300">developer.schwab.com</a></li>
                        <li>Create a new application in the Schwab Developer Portal</li>
                        <li>Configure redirect URI: <code class="bg-gray-700 px-2 py-1 rounded">https://www.arbion.ai/oauth_callback/schwab</code></li>
                        <li>Obtain your Client ID and Client Secret</li>
                        <li>Contact platform administrator to configure these credentials</li>
                    </ol>
                </div>
                
                <div class="bg-red-900 bg-opacity-50 rounded-lg p-4 border border-red-500">
                    <h4 class="font-medium text-red-300 mb-2">Important Notes</h4>
                    <ul class="text-sm space-y-1 list-disc list-inside">
                        <li>This requires a valid Schwab developer account</li>
                        <li>The redirect URI must be configured in your Schwab app settings</li>
                        <li>Tokens expire and will be refreshed automatically</li>
                        <li>Legacy API key method is deprecated</li>
                        <li>Currently requires platform-level configuration</li>
                    </ul>
                </div>
            </div>
            
            <div class="mt-6 flex justify-end">
                <button onclick="closeSchwabInfo()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg">
                    Got it
                </button>
            </div>
        </div>
    </div>
</div>

<script>
function showSchwabInfo() {
    document.getElementById('schwab-oauth-info').classList.remove('hidden');
}

function closeSchwabInfo() {
    document.getElementById('schwab-oauth-info').classList.add('hidden');
}
</script>